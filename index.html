<!DOCTYPE html>
<html lang="th">
<head>
  <meta charset="UTF-8" />
  <title>‡∏£‡∏∞‡∏ö‡∏ö‡πÄ‡∏ö‡∏¥‡∏Å‡∏ß‡∏±‡∏™‡∏î‡∏∏‡∏™‡∏≥‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.2/dist/css/bootstrap.min.css" rel="stylesheet" />
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.5/font/bootstrap-icons.css" />
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.2.0/css/all.min.css" />
  <script src="https://code.jquery.com/jquery-3.6.0.js"></script>
  <script src="//cdn.jsdelivr.net/npm/sweetalert2@11"></script>
  <style>
  <style>
    body {
  font-family: 'Noto Sans Thai', sans-serif;
  background: url("https://raw.githubusercontent.com/060531/images/main/image.png") no-repeat center center fixed;
  background-size: cover;
  margin: 0;
  padding: 0;
  min-height: 100vh;
}

/* ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏†‡∏≤‡∏û background ‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏≠‡∏¢‡∏π‡πà‡∏ö‡∏ô‡∏°‡∏∑‡∏≠‡∏ñ‡∏∑‡∏≠ */
@media (max-width: 768px) {
  body {
    background: url("https://raw.githubusercontent.com/060531/images/main/‡∏£‡∏±‡∏Å‡πÇ‡∏•‡∏Å%20‡∏°‡∏∑‡∏≠‡∏ñ‡∏∑‡∏≠.png") no-repeat center center fixed;
    background-size: cover;
  }
}

#menuSection {
  display: none;
  height: 100vh;
}

#menuContent {
  background-color: rgba(255, 255, 255, 0.85);
  padding: 2rem;
  border-radius: 1rem;
  box-shadow: 0 8px 20px rgba(0, 0, 0, 0.2);
  text-align: center;
  transition: 0.3s;
  width: 100%;
  max-width: 900px;
  margin: 5vh auto 0 auto;
}

#menuContent:hover {
  transform: scale(1.03);
  background-color: rgba(255, 255, 255, 0.95);
}

.btn-main {
  background-color: #6f42c1;
  color: white;
  font-size: 1.25rem;
}

.btn-main:hover {
  background-color: #FFCE00;
  color: black;
}

/* ‡∏à‡∏±‡∏î‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û‡πÉ‡∏ô‡∏´‡∏ô‡πâ‡∏≤‡πÄ‡∏°‡∏ô‡∏π‡∏´‡∏•‡∏±‡∏Å‡πÉ‡∏´‡πâ‡πÅ‡∏™‡∏î‡∏á‡πÅ‡∏ö‡∏ö 2 ‡∏Ñ‡∏≠‡∏•‡∏±‡∏°‡∏ô‡πå‡πÉ‡∏ô desktop */
.item-grid {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
  gap: 1.5rem;
  justify-items: center;
  margin-top: 2rem;
}

.item-grid a {
  text-decoration: none;
  color: inherit;
}

.item-grid img {
  max-width: 100px;
  cursor: pointer;
  transition: transform 0.3s ease;
  display: block;
  margin: 0 auto;
}

.item-grid img:hover {
  transform: scale(1.08);
}

.item-grid .label {
  margin-top: 0.5rem;
  font-weight: bold;
  text-align: center;
}

/* ‡∏ü‡∏≠‡∏£‡πå‡∏° */
#formA4Section {
  display: none;
  padding: 2rem;
}

.card {
  background-color: rgba(255, 255, 255, 0.75);
  border-radius: 1rem;
  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
  backdrop-filter: blur(6px);
  max-width: 700px;
  margin: auto;
  margin-bottom: 2rem;
}

.qBox {
  border: 2px solid #525150;
  border-radius: 12px;
  padding: 1rem;
  margin-bottom: 1rem;
}

.btn-indigo {
  background-color: #6f42c1;
  color: white;
  transition: 0.3s;
}

.btn-indigo:hover {
  background-color: #FFCE00;
  color: #000;
}

#formTableWrapper {
  padding-top: 1rem;
}

#tableWrapper img {
  max-width: 60%;
  border-radius: 8px;
}

table {
  width: 100%;
  border-collapse: collapse;
}

th, td {
  padding: 0.5rem;
  border-bottom: 1px solid #ddd;
}

th {
  background-color: #f8f9fa;
}

.form-header {
  padding-top: 1rem;
  padding-bottom: 1rem;
  border-bottom: 2px solid #6f42c1;
  margin-bottom: 2rem;
}

.form-title {
  font-size: 1.8rem;
  font-weight: 700;
  color: #333;
}

.form-subtitle {
  font-size: 1rem;
  color: #6c757d;
}
  </style>
</head>
<body>

<!-- ===== ‡πÄ‡∏°‡∏ô‡∏π‡∏´‡∏•‡∏±‡∏Å ===== -->
<section id="menuSection">
  <div class="container d-flex justify-content-center align-items-center min-vh-100">
    <div id="menuContent">
<div class="form-header text-center mb-4">
  <h2 class="form-title">üìã ‡∏ü‡∏≠‡∏£‡πå‡∏°‡∏Å‡∏≤‡∏£‡πÄ‡∏ö‡∏¥‡∏Å‡πÉ‡∏ä‡πâ‡∏ß‡∏±‡∏™‡∏î‡∏∏‡∏™‡∏≥‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô</h2>
  <small class="form-subtitle">‡∏™‡∏≥‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô‡πÑ‡∏õ‡∏£‡∏©‡∏ì‡∏µ‡∏¢‡πå‡πÄ‡∏Ç‡∏ï 9</small>
</div>

      <div class="container">
  <div class="row justify-content-center g-4">
    <!-- A4 -->
    <div class="col-6 col-md-4 text-center">
      <a href="?page=a4">
        <img src="https://raw.githubusercontent.com/060531/images/main/a4.jpg"
             alt="‡∏Å‡∏£‡∏∞‡∏î‡∏≤‡∏© A4"
             class="img-fluid rounded shadow-sm selectable-img">
              </a>
        <div class="mt-2 fw-bold">üìÑ ‡∏Å‡∏£‡∏∞‡∏î‡∏≤‡∏© A4</div>
        <div id="stock-a4" class="text-muted">‡∏Ñ‡∏á‡πÄ‡∏´‡∏•‡∏∑‡∏≠: ...</div>
    </div>

    <!-- ‡∏õ‡∏≤‡∏Å‡∏Å‡∏≤ -->
    <div class="col-6 col-md-4 text-center">
      <a href="?page=pen">
        <img src="https://raw.githubusercontent.com/060531/images/main/‡πÄ‡∏ó‡∏õ‡πÉ‡∏™.jpg"
             alt="Clear Tape"
             class="img-fluid rounded shadow-sm selectable-img">
              </a>
        <div class="mt-2 fw-bold">üñäÔ∏è ‡πÄ‡∏ó‡∏õ‡πÉ‡∏™</div>
        <div id="stock-Clear Tape" class="text-muted">‡∏Ñ‡∏á‡πÄ‡∏´‡∏•‡∏∑‡∏≠: ...</div>
    </div>

    <!-- ‡πÄ‡∏ó‡∏õ -->
    <div class="col-6 col-md-4 text-center">
      <a href="?page=tape">
        <img src="https://raw.githubusercontent.com/060531/images/main/‡πÄ‡∏ó‡∏õ.jpg"
             alt="Brown Tape"
             class="img-fluid rounded shadow-sm selectable-img">
              </a>
        <div class="mt-2 fw-bold">üìé ‡πÄ‡∏ó‡∏õ‡∏ô‡πâ‡∏≥‡∏ï‡∏≤‡∏•</div>
        <div id="stock-Brown Tape" class="text-muted">‡∏Ñ‡∏á‡πÄ‡∏´‡∏•‡∏∑‡∏≠: ...</div>
    </div>

    <!-- ‡∏•‡∏ß‡∏î‡πÄ‡∏¢‡πá‡∏ö‡∏Å‡∏£‡∏∞‡∏î‡∏≤‡∏© -->
    <div class="col-6 col-md-4 text-center">
      <a href="?page=stapler">
        <img src="https://raw.githubusercontent.com/060531/images/main/Max8.jpg"
             alt="‡∏•‡∏ß‡∏î‡πÄ‡∏¢‡πá‡∏ö‡∏Å‡∏£‡∏∞‡∏î‡∏≤‡∏©"
             class="img-fluid rounded shadow-sm selectable-img">
            </a>
        <div class="mt-2 fw-bold">üìå ‡∏•‡∏ß‡∏î‡πÄ‡∏¢‡πá‡∏ö‡∏Å‡∏£‡∏∞‡∏î‡∏≤‡∏©</div>
        <div id="stock-stapler" class="text-muted">‡∏Ñ‡∏á‡πÄ‡∏´‡∏•‡∏∑‡∏≠: ...</div>
    </div>
  </div>
  </div>
    </div>
  </div>
</section>

<!-- ===== ‡∏ü‡∏≠‡∏£‡πå‡∏° A4 (‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡∏£‡πà‡∏ß‡∏°‡∏Å‡∏±‡∏ô‡∏ó‡∏∏‡∏Å‡∏ß‡∏±‡∏™‡∏î‡∏∏) ===== -->
<section id="formA4Section">
  <div class="container">
    <div class="card p-4">
      <div class="text-center bg-success text-white py-2 rounded mb-3">
        <h4 class="mb-0" id="formTitle">‡∏ü‡∏≠‡∏£‡πå‡∏°‡∏Å‡∏≤‡∏£‡πÄ‡∏ö‡∏¥‡∏Å‡πÉ‡∏ä‡πâ‡∏ß‡∏±‡∏™‡∏î‡∏∏</h4>
        <small>‡∏™‡∏≥‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô‡πÑ‡∏õ‡∏£‡∏©‡∏ì‡∏µ‡∏¢‡πå‡πÄ‡∏Ç‡∏ï 9</small>
      </div>

        <!-- ‡∏ñ‡πâ‡∏≤‡∏°‡∏µ ?id=xxx ‡∏à‡∏∞‡πÅ‡∏™‡∏î‡∏á‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏î‡πâ‡∏≤‡∏ô‡∏ö‡∏ô -->
        <div id="formTableWrapper" style="display: none">
          <div id="tableWrapper" class="mb-3"></div>
        </div>

        <!-- ======= ‡∏ü‡∏≠‡∏£‡πå‡∏°‡πÄ‡∏£‡∏¥‡πà‡∏° ======= -->
<form id="myForm">
  <!-- ‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡∏Å‡∏≤‡∏£‡πÄ‡∏ö‡∏¥‡∏Å: ‡πÅ‡∏™‡∏î‡∏á‡πÄ‡∏õ‡πá‡∏ô‡∏´‡∏±‡∏ß‡∏Ç‡πâ‡∏≠‡∏ö‡∏ô‡∏™‡∏∏‡∏î -->
  <div class="qBox">
    <label class="form-label">
      <i class="bi bi-arrows-collapse"></i> ‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡∏Å‡∏≤‡∏£‡πÄ‡∏ö‡∏¥‡∏Å
    </label>
    <div>
      <label>
        <input type="radio" name="type" value="use" checked required> ‡πÉ‡∏ä‡πâ (‡∏ï‡∏±‡∏î‡∏™‡∏ï‡πá‡∏≠‡∏Å)
      </label><br />
      <label>
        <input type="radio" name="type" value="admit"> ‡πÄ‡∏ï‡∏¥‡∏°‡∏™‡∏ï‡πá‡∏≠‡∏Å
      </label>
    </div>
  </div>

  <!-- ‡πÅ‡∏ú‡∏ô‡∏Å -->
  <div class="qBox" id="departmentBox">
    <label for="department" class="form-label">
      <i class="bi bi-building"></i> ‡πÅ‡∏ú‡∏ô‡∏Å
    </label>
    <select id="department" name="department" class="form-control" required>
      <option value="" disabled selected>‡πÄ‡∏•‡∏∑‡∏≠‡∏Å..</option>
      <option value="‡∏™‡πà‡∏ß‡∏ô‡∏≠‡∏≥‡∏ô‡∏ß‡∏¢‡∏Å‡∏≤‡∏£‡πÅ‡∏•‡∏∞‡∏ö‡∏∏‡∏Ñ‡∏Ñ‡∏•">‡∏™‡πà‡∏ß‡∏ô‡∏≠‡∏≥‡∏ô‡∏ß‡∏¢‡∏Å‡∏≤‡∏£‡πÅ‡∏•‡∏∞‡∏ö‡∏∏‡∏Ñ‡∏Ñ‡∏•</option>
      <option value="‡∏™‡πà‡∏ß‡∏ô‡∏ó‡∏£‡∏±‡∏û‡∏¢‡πå‡∏™‡∏¥‡∏ô‡πÅ‡∏•‡∏∞‡∏û‡∏±‡∏™‡∏î‡∏∏">‡∏™‡πà‡∏ß‡∏ô‡∏ó‡∏£‡∏±‡∏û‡∏¢‡πå‡∏™‡∏¥‡∏ô‡πÅ‡∏•‡∏∞‡∏û‡∏±‡∏™‡∏î‡∏∏</option>
      <option value="‡∏™‡πà‡∏ß‡∏ô‡∏Å‡∏≤‡∏£‡πÄ‡∏á‡∏¥‡∏ô‡πÅ‡∏•‡∏∞‡∏ö‡∏±‡∏ç‡∏ä‡∏µ">‡∏™‡πà‡∏ß‡∏ô‡∏Å‡∏≤‡∏£‡πÄ‡∏á‡∏¥‡∏ô‡πÅ‡∏•‡∏∞‡∏ö‡∏±‡∏ç‡∏ä‡∏µ</option>
      <option value="‡∏™‡πà‡∏ß‡∏ô‡∏Å‡∏≤‡∏£‡∏ï‡∏•‡∏≤‡∏î‡πÅ‡∏•‡∏∞‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤">‡∏™‡πà‡∏ß‡∏ô‡∏Å‡∏≤‡∏£‡∏ï‡∏•‡∏≤‡∏î‡πÅ‡∏•‡∏∞‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤</option>
      <option value="‡∏™‡πà‡∏ß‡∏ô‡∏£‡∏∞‡∏ö‡∏ö‡πÑ‡∏õ‡∏£‡∏©‡∏ì‡∏µ‡∏¢‡πå‡πÅ‡∏•‡∏∞‡∏™‡∏≤‡∏£‡∏™‡∏ô‡πÄ‡∏ó‡∏®">‡∏™‡πà‡∏ß‡∏ô‡∏£‡∏∞‡∏ö‡∏ö‡πÑ‡∏õ‡∏£‡∏©‡∏ì‡∏µ‡∏¢‡πå‡πÅ‡∏•‡∏∞‡∏™‡∏≤‡∏£‡∏™‡∏ô‡πÄ‡∏ó‡∏®</option>
      <option value="‡∏™‡πà‡∏ß‡∏ô‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£‡∏´‡∏•‡∏±‡∏á‡∏Å‡∏≤‡∏£‡∏Ç‡∏≤‡∏¢‡πÅ‡∏•‡∏∞‡∏Ñ‡∏∏‡∏ì‡∏†‡∏≤‡∏û">‡∏™‡πà‡∏ß‡∏ô‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£‡∏´‡∏•‡∏±‡∏á‡∏Å‡∏≤‡∏£‡∏Ç‡∏≤‡∏¢‡πÅ‡∏•‡∏∞‡∏Ñ‡∏∏‡∏ì‡∏†‡∏≤‡∏û</option>
      <option value="‡∏™‡πà‡∏ß‡∏ô‡∏ó‡∏µ‡∏°‡∏Ç‡∏≤‡∏¢‡πÅ‡∏•‡∏∞‡∏î‡∏π‡πÅ‡∏•‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤">‡∏™‡πà‡∏ß‡∏ô‡∏ó‡∏µ‡∏°‡∏Ç‡∏≤‡∏¢‡πÅ‡∏•‡∏∞‡∏î‡∏π‡πÅ‡∏•‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤</option>
    </select>
  </div>

  <!-- ‡∏ä‡∏∑‡πà‡∏≠‡∏ú‡∏π‡πâ‡πÄ‡∏ö‡∏¥‡∏Å -->
  <div class="qBox" id="fnameBox">
    <label for="fname" class="form-label">
      <i class="bi bi-person-workspace"></i> ‡∏•‡∏á‡∏ä‡∏∑‡πà‡∏≠‡∏ú‡∏π‡πâ‡∏Ç‡∏≠‡πÄ‡∏ö‡∏¥‡∏Å
    </label>
    <select id="fname" name="fname" class="form-control" required>
      <option value="" selected disabled>‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÅ‡∏ú‡∏ô‡∏Å‡∏Å‡πà‡∏≠‡∏ô...</option>
    </select>
  </div>

  <!-- ‡∏ä‡πà‡∏≠‡∏á‡∏à‡∏≥‡∏ô‡∏ß‡∏ô -->
  <div class="qBox">
    <label for="quantity" class="form-label">
      <i class="bi bi-list-ol"></i> ‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏ó‡∏µ‡πà‡πÄ‡∏ö‡∏¥‡∏Å / ‡πÄ‡∏ï‡∏¥‡∏°
    </label>
    <select id="quantity" name="quantity" class="form-control" required>
      <option value="" disabled selected>‡πÄ‡∏•‡∏∑‡∏≠‡∏Å..</option>
      <option value="1">1</option>
      <option value="2">2</option>
      <option value="3">3</option>
      <option value="4">4</option>
      <option value="5">5</option>
      <option value="6">6</option>
      <option value="7">7</option>
      <option value="8">8</option>
      <option value="9">9</option>
      <option value="10">10</option>
      <option value="‡∏≠‡∏∑‡πà‡∏ô ‡πÜ">‡∏≠‡∏∑‡πà‡∏ô ‡πÜ</option>
    </select>
  </div>

  <!-- ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏ï‡∏¥‡∏° ‡∏´‡∏≤‡∏Å‡πÄ‡∏•‡∏∑‡∏≠‡∏Å "‡∏≠‡∏∑‡πà‡∏ô ‡πÜ" -->
  <div class="qBox" id="additionalInfoField" style="display:none">
    <label for="additionalInfo" class="form-label">
      <i class="fa-solid fa-info-circle"></i> ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏ï‡∏¥‡∏°
    </label>
    <input type="text" id="additionalInfo" name="additionalInfo" class="form-control" placeholder="‡∏Å‡∏£‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏ï‡∏¥‡∏°" />
  </div>

  <!-- ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏à‡∏≥‡πÄ‡∏õ‡πá‡∏ô‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡πÄ‡∏ö‡∏¥‡∏Å -->
  <div class="qBox" id="purposeField">
    <label for="purpose" class="form-label">
      <i class="bi bi-journal"></i> ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏à‡∏≥‡πÄ‡∏õ‡πá‡∏ô‡∏ó‡∏µ‡πà‡πÄ‡∏ö‡∏¥‡∏Å
    </label>
    <select id="purpose" name="purpose" class="form-control" required>
      <option value="" disabled selected>‡πÄ‡∏•‡∏∑‡∏≠‡∏Å..</option>
      <option value="‡∏õ‡∏£‡∏∞‡∏à‡∏≥‡πÅ‡∏ú‡∏ô‡∏Å">‡∏õ‡∏£‡∏∞‡∏à‡∏≥‡πÅ‡∏ú‡∏ô‡∏Å</option>
      <option value="‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏ñ‡πà‡∏≤‡∏¢‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£">‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏ñ‡πà‡∏≤‡∏¢‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£</option>
      <option value="‡∏™‡πà‡∏ß‡∏ô‡∏ï‡∏±‡∏ß">‡∏™‡πà‡∏ß‡∏ô‡∏ï‡∏±‡∏ß</option>
    </select>
  </div>

  <!-- ‡∏õ‡∏∏‡πà‡∏° Submit -->
  <div class="d-grid mt-4">
    <button type="button" id="submitBtn" class="btn btn-indigo btn-lg">
      <span id="spinner" class="spinner-border spinner-border-sm d-none" role="status"></span>
      <span id="submitText">Submit</span>
    </button>
  </div>

  <!-- ‡∏õ‡∏∏‡πà‡∏°‡∏Å‡∏•‡∏±‡∏ö‡∏´‡∏ô‡πâ‡∏≤‡∏´‡∏•‡∏±‡∏Å -->
  <div class="text-center mt-4">
    <a href="?" class="btn btn-secondary btn-lg px-4">
      <i class="bi bi-arrow-left-circle"></i> ‡∏Å‡∏•‡∏±‡∏ö‡∏´‡∏ô‡πâ‡∏≤‡∏´‡∏•‡∏±‡∏Å
    </a>
  </div>
</form>

<script>
  const usersByDepartment = {
    "‡∏™‡πà‡∏ß‡∏ô‡∏≠‡∏≥‡∏ô‡∏ß‡∏¢‡∏Å‡∏≤‡∏£‡πÅ‡∏•‡∏∞‡∏ö‡∏∏‡∏Ñ‡∏Ñ‡∏•": ["‡∏ô‡∏≤‡∏¢‡∏™‡∏Å‡∏• ‡πÅ‡∏Å‡πâ‡∏ß‡∏™‡∏∏‡∏ß‡∏£‡∏£‡∏ì", "‡∏ß‡πà‡∏≤‡∏ó‡∏µ‡πà ‡∏£.‡∏ï.‡∏≠‡∏∏‡∏ó‡∏ò‡∏¥‡∏®‡∏±‡∏Å‡∏î‡∏¥‡πå ‡∏û‡∏π‡πà‡∏ß‡∏ì‡∏¥‡∏ä‡∏¢‡πå", "‡∏ô‡∏≤‡∏á‡∏•‡∏≤‡∏†‡∏ô‡∏∏‡∏ä ‡∏°‡∏≤‡∏Å‡∏°‡∏ì‡∏µ", "‡∏ô‡∏≤‡∏á‡∏™‡∏≤‡∏ß‡∏ô‡∏±‡∏ô‡∏ó‡∏¥‡∏Å‡∏≤ ‡∏à‡∏±‡∏ô‡∏ó‡∏£‡πå‡∏Ñ‡∏á", "‡∏ô‡∏≤‡∏á‡∏™‡∏≤‡∏ß‡∏®‡∏®‡∏¥‡∏ß‡∏¥‡∏°‡∏• ‡πÇ‡∏™‡∏ï‡∏ñ‡∏¥‡∏™‡∏ñ‡∏≤‡∏ß‡∏£", "‡∏ô‡∏≤‡∏á‡∏™‡∏≤‡∏ß‡∏à‡∏¥‡∏£‡∏≤‡∏†‡∏£‡∏ì‡πå ‡∏õ‡∏¥‡πà‡∏ô‡∏ó‡∏≠‡∏á", "‡∏ô‡∏≤‡∏á‡∏™‡∏≤‡∏ß‡∏®‡∏®‡∏¥‡∏Å‡∏≤‡∏ç‡∏à‡∏ô‡πå ‡πÑ‡∏ß‡πÄ‡∏£‡∏∑‡∏≠‡∏á‡∏®‡∏¥‡∏£‡∏¥‡∏û‡∏á‡∏®‡πå", "‡∏ô‡∏≤‡∏á‡∏™‡∏≤‡∏ß‡∏Å‡∏±‡∏ô‡∏ó‡∏¥‡∏°‡∏≤ ‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡πÅ‡∏Å‡πâ‡∏ß", "‡∏ß‡πà‡∏≤‡∏ó‡∏µ‡πà ‡∏£.‡∏ï.‡∏™‡∏∏‡∏Å‡∏§‡∏©‡∏è‡∏¥‡πå ‡∏™‡∏∏‡∏£‡∏¥‡∏¢‡∏ß‡∏á‡∏®‡πå", "‡∏ô‡∏≤‡∏á‡∏™‡∏≤‡∏ß‡∏õ‡∏£‡∏µ‡∏î‡∏≤ ‡∏à‡∏±‡∏ô‡∏ó‡∏£‡πå‡∏à‡∏∏‡∏¨‡∏≤", "‡∏ô‡∏≤‡∏¢‡∏≠‡∏£‡∏£‡∏ñ‡∏û‡∏• ‡∏ß‡∏±‡∏ô‡πÄ‡∏ä‡πâ‡∏≤"],
    "‡∏™‡πà‡∏ß‡∏ô‡∏ó‡∏£‡∏±‡∏û‡∏¢‡πå‡∏™‡∏¥‡∏ô‡πÅ‡∏•‡∏∞‡∏û‡∏±‡∏™‡∏î‡∏∏": ["‡∏ô‡∏≤‡∏¢‡∏™‡∏°‡∏ä‡∏≤‡∏¢ ‡∏Ç‡∏∏‡∏ô‡∏†‡∏±‡∏Å‡∏î‡∏µ", "‡∏ô‡∏≤‡∏¢‡∏ä‡∏±‡∏¢‡∏ô‡∏£‡∏¥‡∏ô‡∏ó‡∏£‡πå ‡∏ï‡∏±‡πâ‡∏á‡∏Å‡∏¥‡∏à‡∏ß‡∏£‡∏Å‡∏∏‡∏•", "‡∏ô‡∏≤‡∏¢‡∏ô‡∏¥‡∏°‡∏¥‡∏ï ‡∏û‡∏µ‡∏û‡∏∞‡∏£‡∏∞‡∏û‡∏£‡∏£‡∏ì", "‡∏ô‡∏≤‡∏á‡∏™‡∏≤‡∏ß‡∏ä‡∏°‡∏û‡∏π‡∏ô‡∏ó ‡∏°‡∏ì‡∏µ", "‡∏ô‡∏≤‡∏¢‡∏≠‡∏ô‡∏∏‡∏ß‡∏±‡∏ï‡∏ì‡πå ‡∏™‡∏∏‡∏î‡∏£‡∏±‡∏Å", "‡∏ô‡∏≤‡∏¢‡∏≠‡∏£‡∏∏‡∏ì‡∏ä‡∏±‡∏¢ ‡∏£‡∏±‡∏ï‡∏ô‡πÑ‡∏û", "‡∏ô‡∏≤‡∏¢‡∏ß‡∏µ‡∏£‡∏û‡∏á‡∏®‡πå ‡∏Ñ‡∏á‡∏ö‡∏∏‡∏£‡∏µ", "‡∏ô‡∏≤‡∏á‡∏™‡∏≤‡∏ß‡∏Å‡∏£‡∏£‡∏ì‡∏¥‡∏Å‡∏≤‡∏£‡πå ‡∏ö‡∏∏‡∏ç‡∏ó‡∏≠‡∏á", "‡∏ô‡∏≤‡∏¢‡∏ò‡∏ß‡∏±‡∏ä‡∏ä‡∏±‡∏¢ ‡πÄ‡∏Å‡∏∑‡πâ‡∏≠‡∏•‡∏≤‡∏¢", "‡∏ô‡∏≤‡∏¢‡∏ß‡∏∏‡∏í‡∏¥‡∏†‡∏±‡∏ó‡∏£ ‡∏û‡∏£‡πâ‡∏≠‡∏°‡∏°‡∏π‡∏•", "‡∏ô‡∏≤‡∏¢‡∏ò‡∏ô‡∏û‡∏• ‡πÄ‡∏à‡πâ‡∏≤‡πÄ‡∏™‡πâ‡∏á", "‡∏ô‡∏≤‡∏¢‡∏ß‡∏£‡∏ò‡∏ô ‡∏≠‡∏ô‡∏∏‡∏™‡∏≤‡∏£"],
    "‡∏™‡πà‡∏ß‡∏ô‡∏Å‡∏≤‡∏£‡πÄ‡∏á‡∏¥‡∏ô‡πÅ‡∏•‡∏∞‡∏ö‡∏±‡∏ç‡∏ä‡∏µ": ["‡∏ô‡∏≤‡∏á‡∏†‡∏±‡∏ì‡∏ë‡∏¥‡∏£‡∏©‡∏≤ ‡πÅ‡∏ã‡πà‡∏•‡∏¥‡πà‡∏°", "‡∏ô‡∏≤‡∏á‡∏ß‡∏ô‡∏¥‡∏î‡∏≤ ‡πÄ‡∏Å‡∏∑‡πâ‡∏≠‡∏•‡∏≤‡∏¢", "‡∏ô‡∏≤‡∏á‡∏™‡∏≤‡∏ß‡∏ò‡∏±‡∏ç‡∏•‡∏±‡∏Å‡∏©‡∏ì‡πå ‡∏Ç‡∏∏‡∏ô‡∏†‡∏±‡∏Å‡∏î‡∏µ", "‡∏ô‡∏≤‡∏á‡∏™‡∏≤‡∏ß‡∏Ç‡∏ô‡∏¥‡∏©‡∏ê‡∏≤ ‡πÑ‡∏ä‡∏¢‡∏°‡∏∏‡∏ì‡∏µ", "‡∏ô‡∏≤‡∏á‡∏™‡∏≤‡∏ß‡∏Å‡∏±‡∏ì‡∏ê‡∏¥‡∏Å‡∏≤ ‡πÅ‡∏ã‡∏∞‡∏≠‡∏≤‡∏´‡∏•‡∏≥"],
    "‡∏™‡πà‡∏ß‡∏ô‡∏Å‡∏≤‡∏£‡∏ï‡∏•‡∏≤‡∏î‡πÅ‡∏•‡∏∞‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤": ["‡∏ô‡∏≤‡∏á‡∏™‡∏≤‡∏ß‡∏Å‡∏∏‡∏•‡∏§‡∏î‡∏µ ‡∏ó‡∏≠‡∏á‡∏ô‡∏û‡∏Ñ‡∏∏‡∏ì", "‡∏à.‡∏≠.‡∏™‡∏±‡∏°‡∏û‡∏±‡∏ô‡∏ò‡πå ‡∏≠‡∏£‡∏±‡∏ç‡πÄ‡∏ß‡∏ó‡∏¢‡πå", "‡∏ô‡∏≤‡∏¢‡∏ì‡∏±‡∏ê‡∏û‡∏á‡∏®‡πå ‡∏ú‡πà‡∏≠‡∏á‡∏≠‡∏≥‡∏†‡∏£‡∏ì‡πå", "‡∏ô‡∏≤‡∏¢‡∏®‡∏∏‡∏†‡∏Å‡∏§‡∏ï ‡πÑ‡∏ó‡∏¢‡∏ô‡∏∏‡∏Å‡∏π‡∏•"],
    "‡∏™‡πà‡∏ß‡∏ô‡∏£‡∏∞‡∏ö‡∏ö‡πÑ‡∏õ‡∏£‡∏©‡∏ì‡∏µ‡∏¢‡πå‡πÅ‡∏•‡∏∞‡∏™‡∏≤‡∏£‡∏™‡∏ô‡πÄ‡∏ó‡∏®": ["‡∏ô‡∏≤‡∏á‡∏™‡∏≤‡∏ß‡∏û‡∏£‡∏û‡∏¥‡∏°‡∏• ‡∏ó‡∏≠‡∏á‡∏ï‡∏£‡∏±‡∏á", "‡∏ô‡∏≤‡∏¢‡∏Å‡∏§‡∏©‡∏é‡∏≤ ‡∏Å‡∏∏‡πâ‡∏á‡πÅ‡∏Å‡πâ‡∏ß", "‡∏ô‡∏≤‡∏¢‡∏Å‡∏£‡∏ì‡πå‡∏î‡∏ô‡∏±‡∏¢ ‡∏™‡∏¥‡∏á‡∏´‡πå‡∏Ñ‡∏≥", "‡∏ô‡∏≤‡∏¢‡∏ß‡∏¥‡∏™‡∏π‡∏ï‡∏£ ‡∏´‡∏°‡∏∑‡πà‡∏ô‡∏≠‡∏£‡∏∏‡∏ì", "‡∏ô‡∏≤‡∏¢‡∏Å‡∏£‡∏Å‡∏ä ‡∏£‡∏±‡∏ï‡∏ô‡∏û‡∏±‡∏ô‡∏ò‡πå", "‡∏ô‡∏≤‡∏¢‡∏à‡∏¥‡∏£‡∏≤‡∏¢‡∏∏ ‡∏®‡∏®‡∏¥‡∏ò‡∏£"],
    "‡∏™‡πà‡∏ß‡∏ô‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£‡∏´‡∏•‡∏±‡∏á‡∏Å‡∏≤‡∏£‡∏Ç‡∏≤‡∏¢‡πÅ‡∏•‡∏∞‡∏Ñ‡∏∏‡∏ì‡∏†‡∏≤‡∏û": ["‡∏ô‡∏≤‡∏¢‡∏ä‡∏±‡∏¢‡∏ß‡∏∏‡∏í‡∏¥ ‡∏ñ‡∏ô‡∏≠‡∏°‡∏®‡∏£‡∏µ", "‡∏ô‡∏≤‡∏¢‡∏Å‡∏§‡∏©‡∏î‡∏≤ ‡∏Ñ‡∏≥‡∏à‡∏µ‡∏ô", "‡∏ô‡∏≤‡∏¢‡∏Ñ‡∏°‡∏ä‡∏≤‡∏ç ‡∏™‡∏±‡∏ï‡∏ï‡∏´‡∏¥‡∏£‡∏±‡∏ç", "‡∏ô‡∏≤‡∏á‡∏™‡∏≤‡∏ß‡∏£‡∏ä‡∏è ‡∏≠‡∏¥‡∏ô‡∏ó‡∏°‡∏∞‡πÇ‡∏ô", "‡∏ô‡∏≤‡∏á‡∏™‡∏≤‡∏ß‡∏≠‡∏∞‡∏£‡∏µ‡∏ô‡∏≤ ‡∏°‡∏∞‡∏™‡∏≤‡∏•‡∏µ"],
    "‡∏™‡πà‡∏ß‡∏ô‡∏ó‡∏µ‡∏°‡∏Ç‡∏≤‡∏¢‡πÅ‡∏•‡∏∞‡∏î‡∏π‡πÅ‡∏•‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤": ["‡∏ô‡∏≤‡∏¢‡∏°‡∏∞‡∏Å‡∏≤‡∏£‡∏¥‡∏° ‡∏î‡∏≠‡πÄ‡∏•‡∏≤‡∏∞", "‡∏ô‡∏≤‡∏¢‡∏Å‡∏§‡∏ï‡∏ô‡∏±‡∏¢ ‡πÄ‡∏Å‡∏∑‡πâ‡∏≠‡∏ô‡∏∏‡πà‡∏ô", "‡∏ô‡∏≤‡∏¢‡∏ü‡∏≤‡∏î‡∏¥‡∏™ ‡πÄ‡∏ö‡∏ç‡∏≠‡∏≤‡πÄ‡∏´‡∏°‡πá‡∏î", "‡∏ô‡∏≤‡∏á‡∏™‡∏≤‡∏ß‡∏ò‡∏§‡∏Ñ‡∏†‡∏£ ‡∏°‡∏´‡πÇ‡∏ä‡∏Ñ‡∏†‡∏±‡∏ó‡∏£‡πÄ‡∏ß‡∏Ñ‡∏¥‡∏ô"]
  };

  document.getElementById('department').addEventListener('change', function () {
    const department = this.value;
    const fnameSelect = document.getElementById('fname');
    fnameSelect.innerHTML = '<option value="" disabled selected>‡πÄ‡∏•‡∏∑‡∏≠‡∏Å..</option>';
    if (usersByDepartment[department]) {
      usersByDepartment[department].forEach(name => {
        const option = document.createElement('option');
        option.value = name;
        option.textContent = name;
        fnameSelect.appendChild(option);
      });
    }
  });

  document.querySelectorAll('input[name="type"]').forEach(radio => {
    radio.addEventListener('change', () => {
      const selectedType = document.querySelector('input[name="type"]:checked').value;
      const purposeField = document.getElementById('purposeField');
      const departmentBox = document.getElementById('departmentBox');
      const fnameBox = document.getElementById('fnameBox');
      const fnameSelect = document.getElementById('fname');

      if (selectedType === 'admit') {
        purposeField.style.display = 'none';
        departmentBox.style.display = 'none';
        fnameBox.style.display = 'none';
        fnameSelect.innerHTML = '';
        const opt = document.createElement('option');
        opt.value = "‡∏ß‡πà‡∏≤‡∏ó‡∏µ‡πà ‡∏£.‡∏ï.‡∏™‡∏∏‡∏Å‡∏§‡∏©‡∏è‡∏¥‡πå ‡∏™‡∏∏‡∏£‡∏¥‡∏¢‡∏ß‡∏á‡∏®‡πå";
        opt.textContent = "‡∏ß‡πà‡∏≤‡∏ó‡∏µ‡πà ‡∏£.‡∏ï.‡∏™‡∏∏‡∏Å‡∏§‡∏©‡∏è‡∏¥‡πå ‡∏™‡∏∏‡∏£‡∏¥‡∏¢‡∏ß‡∏á‡∏®‡πå";
        opt.selected = true;
        fnameSelect.appendChild(opt);
      } else {
        purposeField.style.display = 'block';
        departmentBox.style.display = 'block';
        fnameBox.style.display = 'block';
        fnameSelect.innerHTML = '<option value="" selected disabled>‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÅ‡∏ú‡∏ô‡∏Å‡∏Å‡πà‡∏≠‡∏ô...</option>';
      }
    });
  });

  document.getElementById('quantity').addEventListener('change', function () {
    document.getElementById('additionalInfoField').style.display =
      this.value === '‡∏≠‡∏∑‡πà‡∏ô ‡πÜ' ? 'block' : 'none';
  });

  window.addEventListener('DOMContentLoaded', () => {
    const selectedType = document.querySelector('input[name="type"]:checked').value;
    const purposeField = document.getElementById('purposeField');
    const departmentBox = document.getElementById('departmentBox');
    const fnameBox = document.getElementById('fnameBox');
    const fnameSelect = document.getElementById('fname');

    if (selectedType === 'admit') {
      purposeField.style.display = 'none';
      departmentBox.style.display = 'none';
      fnameBox.style.display = 'none';
      fnameSelect.innerHTML = '';
      const opt = document.createElement('option');
      opt.value = "‡∏ß‡πà‡∏≤‡∏ó‡∏µ‡πà ‡∏£.‡∏ï.‡∏™‡∏∏‡∏Å‡∏§‡∏©‡∏è‡∏¥‡πå ‡∏™‡∏∏‡∏£‡∏¥‡∏¢‡∏ß‡∏á‡∏®‡πå";
      opt.textContent = "‡∏ß‡πà‡∏≤‡∏ó‡∏µ‡πà ‡∏£.‡∏ï.‡∏™‡∏∏‡∏Å‡∏§‡∏©‡∏è‡∏¥‡πå ‡∏™‡∏∏‡∏£‡∏¥‡∏¢‡∏ß‡∏á‡∏®‡πå";
      opt.selected = true;
      fnameSelect.appendChild(opt);
    } else {
      purposeField.style.display = 'block';
      departmentBox.style.display = 'block';
      fnameBox.style.display = 'block';
    }
  });
</script>
        <!-- ======= ‡∏à‡∏ö‡∏ü‡∏≠‡∏£‡πå‡∏° A4 ======= -->
      </div>
    </div>
  </section>

<!-- Firebase SDKs ‡∏Ñ‡∏ß‡∏£‡∏≠‡∏¢‡∏π‡πà‡∏Å‡πà‡∏≠‡∏ô‡πÇ‡∏Ñ‡πâ‡∏î JS ‡∏ó‡∏µ‡πà‡πÉ‡∏ä‡πâ Firebase -->

  <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-database-compat.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
  <script>
    const firebaseConfig = {
      apiKey: "AIzaSyD-zmfm2lwN004FtxD-ApZXjleUQsbqIhE",
      authDomain: "office-supply-form.firebaseapp.com",
      databaseURL: "https://office-supply-form-default-rtdb.firebaseio.com",
      projectId: "office-supply-form",
      storageBucket: "office-supply-form.appspot.com",
      messagingSenderId: "165912626330",
      appId: "1:165912626330:web:d802857b55662600a38b23",
      measurementId: "G-TVDPCWZ78C"
    };
    firebase.initializeApp(firebaseConfig);
    const db = firebase.database();

    function toggleSections() {
      const page = new URLSearchParams(window.location.search).get("page");
      const menu = document.getElementById("menuSection");
      const form = document.getElementById("formA4Section");
      if (page) {
        menu.style.display = "none";
        form.style.display = "block";
        document.getElementById("formTitle").innerText = `‡∏ü‡∏≠‡∏£‡πå‡∏°‡∏Å‡∏≤‡∏£‡πÄ‡∏ö‡∏¥‡∏Å‡πÉ‡∏ä‡πâ ${page}`;
      } else {
        menu.style.display = "block";
        form.style.display = "none";
      }
    }

    function updateStock(item, quantity, type) {
      const stockRef = db.ref(`stock/${item}`);
      stockRef.transaction(current => {
        if (current === null) current = 0;
        return type === 'admit' ? current + quantity : Math.max(current - quantity, 0);
      });
    }

    document.getElementById('submitBtn').addEventListener('click', () => {
      const fname = document.getElementById('fname').value;
      const department = document.getElementById('department').value;
      const quantityRaw = document.getElementById('quantity').value;
      const additionalInfo = document.getElementById('additionalInfo').value || '';
      const type = document.querySelector('input[name="type"]:checked').value;
      const purpose = document.getElementById('purpose')?.value || '';
      const page = new URLSearchParams(window.location.search).get('page') || 'unknown';
      const quantity = quantityRaw === "‡∏≠‡∏∑‡πà‡∏ô ‡πÜ" ? parseInt(additionalInfo) : parseInt(quantityRaw);

      if (!fname || !department || !quantity || isNaN(quantity)) {
        Swal.fire({ icon: 'warning', title: '‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏´‡πâ‡∏Ñ‡∏£‡∏ö‡∏ñ‡πâ‡∏ß‡∏ô' });
        return;
      }

      document.getElementById('submitText').innerText = '‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•...';
      document.getElementById('spinner').classList.remove('d-none');

      const entry = {
        timestamp: new Date().toISOString(),
        time: new Date().toLocaleString(),
        fname,
        department,
        quantity,
        purpose,
        type,
        page
      };

      db.ref('supplies').push(entry, (error) => {
        document.getElementById('submitText').innerText = 'Submit';
        document.getElementById('spinner').classList.add('d-none');
        if (error) {
          Swal.fire({ icon: 'error', title: '‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å' });
        } else {
          updateStock(page, quantity, type);
          document.getElementById('myForm').reset();
          document.getElementById('additionalInfoField').style.display = 'none';
          Swal.fire({ icon: 'success', title: '‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢' });
        }
      });
    });

    document.getElementById('quantity').addEventListener('change', function () {
      document.getElementById('additionalInfoField').style.display = this.value === '‡∏≠‡∏∑‡πà‡∏ô ‡πÜ' ? 'block' : 'none';
    });

    document.querySelectorAll('input[name="type"]').forEach(radio => {
      radio.addEventListener('change', () => {
        const type = document.querySelector('input[name="type"]:checked').value;
        document.getElementById('purposeField').style.display = type === 'admit' ? 'none' : 'block';
      });
    });

    window.addEventListener('DOMContentLoaded', () => {
      toggleSections();
      const defaultType = document.querySelector('input[name="type"]:checked').value;
      document.getElementById('purposeField').style.display = defaultType === 'admit' ? 'none' : 'block';
    });
  </script>
</body>
<script>
  const stockElements = {
    "a4": document.getElementById("stock-a4"),
    "Clear Tape": document.getElementById("stock-Clear Tape"),
    "Brown Tape": document.getElementById("stock-Brown Tape"),
    "stapler": document.getElementById("stock-stapler")
  };

  firebase.database().ref("stock").on("value", (snapshot) => {
    const stockData = snapshot.val() || {};
    for (const key in stockElements) {
      const el = stockElements[key];
      const value = stockData[key] ?? "‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•";
      if (el) el.innerText = `‡∏Ñ‡∏á‡πÄ‡∏´‡∏•‡∏∑‡∏≠: ${value}`;
    }
  });
</script>
</html>